
&НаКлиенте
Процедура ДекорацияОплатитьСервисНажатие(Элемент)
	
	Попытка
		
		IE = Новый COMОбъект("InternetExplorer.Application");
		IE.Visible = Истина;
		IE.Navigate("https://www.diadoc.ru/order1c?comment=модуль_1C_8_3_управляемое_приложение");
		Пока IE.readyState < 4 Цикл
		КонецЦикла;
		
		//заполняем поля формы заявки в соотвествии с сертификатом (если был)
		Если Параметры.СписокОрганизаций.Количество() > 0 Тогда 
			ДанныеДляФормы = Параметры.СписокОрганизаций[0].Значение;
			IE.Document.getElementByID("OrderForm_Fio").value = ДанныеДляФормы.ФИО;
			IE.Document.getElementByID("OrderForm_Inn").value = ДанныеДляФормы.Inn;
			IE.Document.getElementByID("OrderForm_Kpp").value = ДанныеДляФормы.Kpp;
			IE.Document.getElementByID("OrderForm_OrganizationTitle").value = ДанныеДляФормы.Name;
		КонецЕсли;	
		
	Исключение		
	КонецПопытки;
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ПолеСообщения.Очистить();
	
	ПолеСообщения.УстановитьТекст("Оплаченный период интеграции с сервисом ""Диадок"" 
									|истек у следующих организаций: 
									| ");
	
	Для Каждого ТекОрганизация Из Параметры.СписокОрганизаций Цикл
		ДанныеОрганизации = ТекОрганизация.Значение;
		ПолеСообщения.ДобавитьСтроку(" - " + ДанныеОрганизации.Name + "(ИНН - " + ДанныеОрганизации.Inn + ", КПП - " + ДанныеОрганизации.Kpp + ")");
	КонецЦикла;
	
КонецПроцедуры
